<p-breadcrumb class="max-w-full" [model]="breadcrumbs" [home]="home"></p-breadcrumb>
<div class="grid">
    <div class="col-12">
        <div class="card">
            <div class="flex align-items-center justify-content-between flex-column sm:flex-row gap-2">
                <h5>{{title}}</h5>
                <button pButton label="Quay lại" class="p-button-outlined mr-2 text-blue-500" icon="pi pi-chevron-left"
                    (click)="back()">
                </button>
            </div>

            <form class="grid formgrid p-fluid" #roleForm="ngForm">
                <div class="field mb-4 col-12 md:col-4">
                    <label for="code" class="font-medium text-900">Code</label>
                    <input id="code" name="code" type="text" pinputtext="" class="p-inputtext p-component p-element"
                        [(ngModel)]="role.code" required disabled>
                </div>
                <div class="field mb-4 col-12 md:col-4">
                    <label for="title" class="font-medium text-900">Title</label>
                    <input id="title" name="title" type="text" pinputtext="" class="p-inputtext p-component p-element"
                        [(ngModel)]="role.title" required>
                </div>
                <div class="field mb-4 col-12 md:col-4 mt-2 pt-5">
                    <p-checkbox label="Status" name="status" [(ngModel)]="role.status" value="Status" [binary]="true">
                    </p-checkbox>
                </div>
            </form>

            <div class="surface-border border-top-1 opacity-50 mt-3 col-12"></div>

            <div class="flex align-items-center justify-content-between flex-column sm:flex-row gap-2 mb-5">
                <div>
                    <p-checkbox id="checkedAll" name="checkedAll" class="mr-2" [(ngModel)]="params.checkedAll"
                        (ngModelChange)="changCheckedAll()" [binary]="true">
                    </p-checkbox>
                    <label for="checkedAll">Hiển thị tất cả quyền</label>
                </div>

                <div class="text-right">
                    <button pButton label="Lưu" class="p-button-outlined mr-2 text-green-500" icon="pi pi-save"
                        (click)="save()" [disabled]="roleForm.invalid">
                    </button>
                    <button pButton label="Làm lại" class="p-button-outlined mr-2 text-orange-500" icon="pi pi-refresh"
                        (click)="refresh()">
                    </button>
                    <button pButton label="Hủy" class="p-button-outlined mr-2 text-red-500" icon="pi pi-times"
                        (click)="back()">
                    </button>
                </div>
            </div>

            <p-table #dt1 [value]="roles" dataKey="id" [rowHover]="true" responsiveLayout="scroll"
                styleClass="p-datatable-gridlines p-size-normal">
                <!-- Table thread -->
                <ng-template pTemplate="header">
                    <tr>
                        <th class="text-primary">
                            Functions
                        </th>
                        <th class="text-primary" style="width: 10%">
                            <p-checkbox id="checkAllRoles" name="checkAllRoles" class="mr-2" [(ngModel)]="checkAllRoles"
                                (ngModelChange)="changeCheckAllRoles()" [binary]="true">
                            </p-checkbox>
                            <label for="checkAllRoles">Check All</label>
                        </th>
                        <th [colSpan]="maxAction" class="text-primary">Actions</th>
                    </tr>
                </ng-template>

                <!-- Table body -->
                <ng-template pTemplate="body" let-item let-ri="rowIndex">
                    <tr>
                        <td>{{item.controller}} - {{item.title}}</td>
                        <td>
                            <p-checkbox [name]="'checkall_' + item.id" [(ngModel)]="item.isChecked"
                                (ngModelChange)="parentChecked(item)" [binary]="true">
                            </p-checkbox>
                        </td>
                        <td *ngFor="let act of item.actions">
                            <p-checkbox *ngIf="act.action" class="mr-2" [id]="act.action + item.id"
                                [name]="act.action + item.id" [(ngModel)]="act.isChecked"
                                (ngModelChange)="childChecked(item, act.action)" [binary]="true">
                            </p-checkbox>
                            <label [for]="act.action + item.id">{{act.action}}</label>
                        </td>
                    </tr>
                </ng-template>

                <!-- Data not found -->
                <ng-template pTemplate="emptymessage">
                    <tr>
                        <td colspan="100%" class="text-center text-orange-500">Không có dữ liệu.</td>
                    </tr>
                </ng-template>
            </p-table>

            <div class="mt-3 text-right">
                <button pButton label="Lưu" class="p-button-outlined mr-2 text-green-500" icon="pi pi-save"
                    (click)="save()">
                </button>
                <button pButton label="Làm lại" class="p-button-outlined mr-2 text-orange-500" icon="pi pi-refresh"
                    (click)="refresh()">
                </button>
                <button pButton label="Hủy" class="p-button-outlined mr-2 text-red-500" icon="pi pi-times"
                    (click)="back()">
                </button>
            </div>
        </div>
    </div>
</div>